@model Koshop.DomainClasses.Module

@{
    Koshop.DataLayer.AppDbContext db = new Koshop.DataLayer.AppDbContext();
}

<div id="wrapper" style="display:contents">
    <input type="checkbox" id="menu" name="menu" class="menu-checkbox">
    <div class="menu">
        <div style="top:85px">
            <label id="closemenu" style="color:#ffc900" class="mainToggle menu-toggle" for="menu"><span class="menutype">بستن</span></label>
            <label id="openmenu"  class="mainToggle menu-toggle" for="menu"><span class="menutype">کالا و خدمات</span></label>
        </div>
        <div class="groups">
            <ul>
                @ShowTree(db.ProductGroups.Where(s => s.Depth == 0))
            </ul>
        </div>
    </div>
</div>


@helper ShowTree(IEnumerable<Koshop.DomainClasses.ProductGroup> product_Groups)
{
    Koshop.DataLayer.AppDbContext db = new Koshop.DataLayer.AppDbContext();

foreach (var item in product_Groups)
{
        <li>
            @if (item.Depth == 0)
            {
            }   
            @if (db.ProductGroups.Any(s => s.ParentId == item.ProductGroupId))
            {
                <label class="menutype" for="menu-@item.ProductGroupId">@item.GroupTitle</label>
                <input type="checkbox" id="menu-@item.ProductGroupId" name="menu-@item.ProductGroupId" class="menu-checkbox menutype">
                <div class="menu">
                    <label class="menutype test" for="menu-@item.ProductGroupId" style="color: #ffc900;"><span class="menutype"> @item.GroupTitle</span></label>
                    <div class="groups">
                        <ul>
                            @ShowTree(db.ProductGroups.Where(s => s.ParentId == item.ProductGroupId))
                        </ul>
                    </div>
                </div>
            }
            else
            {
                <a href="/Product/search?SlctGrpFilt=@item.GroupTitle.Trim().Replace(" ","-")"> @item.GroupTitle</a>
            }
        </li>
    }
}
